/*! 
 * Conformist.js 0.9
 * 
 * Copyright 2015 Jonathan Skowera
 * Released under the MIT License
 * https://github.com/expz/conformist.git
 *
 * Based loosely on BigText by Zach Leatherman
 * Requires jQuery v1
 */
(function(a,b){var d=a.Conformist;var c=b.fn.conform;a.Conformist={minFontSizePx:10,maxFontSizePx:528,childSelector:":not(br,script,canvas,del,embed,figure,hr,img,object)",exemptClass:"nonconformist",styleIdPrefix:"conformist-style",conformistIdPrefix:"conformist-box",lineClassPrefix:"conformist-line",noConflict:function(e){if(e){b.fn.conform=c;a.Conformist=d}return Conformist},getStyleId:function(e){return Conformist.styleIdPrefix+"-"+e},generateStyleTag:function(f,e){return b('<style id="'+Conformist.getStyleId(f)+'">'+e.join("\n")+"</style>")},clearCss:function(e){b("#"+Conformist.getStyleId(e)).remove()},generateCss:function(h,g){var f=[];Conformist.clearCss(h);for(var e=0;e<g.fontSizes.length;e++){f.push("#"+h+" ."+Conformist.lineClassPrefix+e+" {"+(g.minFontSizes[e]?" white-space: normal;":"")+(g.fontSizes[e]?" font-size: "+g.fontSizes[e]+"em;":"")+(g.wordSpacings[e]?" word-spacing: "+g.wordSpacings[e]+"px;":"")+"}")}return Conformist.generateStyleTag(h,f)},init:function(){if(!b("#"+Conformist.getStyleId("global")).length){b("head").append(Conformist.generateStyleTag("global",[".conform * { white-space: nowrap; };",".conform > * { display: block; };",".conform ."+Conformist.exemptClass+" { white-space: normal; }"]))}},calculateFontSize:function(r,q){var g,x,n;if(r.hasClass(Conformist.exemptClass)){g=null;n=false;x=null}else{var v=r.parent();var h=parseFloat(v.css("font-size"));var u,f,j,s,e,l;for(var w=1;w<=3;w++){u=parseFloat(r.css("font-size"))/h;f=(u/r.width()).toFixed(6);j=q*f*0.995;r.css("font-size",j+"em")}while(r.width()>q){j*=0.99;r.css("font-size",j+"em")}var p=r.css("font-size");if(p>this.maxFontSizePx){g=this.maxFontSizePx/h}else{if(!!this.minFontSizePx&&p<this.minFontSizePx){g=this.minFontSizePx/h;r.css("white-space","normal")}else{g=j}}r.css("font-size",g+"em");var z=5,t=3;var o=r.width();s=parseFloat(r.css("word-spacing"))||0;r.css("word-spacing",(s+z)+"px");r.get(0).style.wordSpacing=(s+z)+"px";e=(q-o)*(z/(r.width()-o))/t;r.css("word-spacing",s+"px");r.get(0).style.wordSpacing=s+"px";l=s;for(var y=0;y<=t;y++){if(r.width()>q){break}l=s;s+=e;r.css("word-spacing",s+"px");r.get(0).style.wordSpacing=s+"px"}r.css("word-spacing",l+"px");r.get(0).style.wordSpacing=l+"px";x=l}return{fontSize:g,wordSpacing:x,minFontSize:n}},_conform:function(){Conformist.init();var e=0;this.each(function(){var l=b(this);var h=Conformist.childSelector?l.find(Conformist.childSelector):l.children();var g=l.width();var k=l.attr("id");if(!k){k=Conformist.conformistIdPrefix+"-"+e++;l.attr("id",k)}Conformist.clearCss(k);h.addClass(function(m,n){return[n.replace(new RegExp("\\b"+Conformist.lineClassPrefix+"\\d+\\b"),""),Conformist.lineClassPrefix+m].join(" ")}).css("font-size","");var j=l.clone(true).addClass("conform-cloned").css({fontFamily:l.css("font-family"),textTransform:l.css("text-transform"),wordSpacing:l.css("word-spacing"),position:"absolute","float":"left",width:"",left:-9999,top:-9999}).appendTo(document.body);var f=Conformist.childSelector?j.find(Conformist.childSelector):j.children();var i={fontSizes:[],minFontSizes:[],wordSpacings:[]};f.each(function(){b(this).css("float","left").css("font-size","");var m=Conformist.calculateFontSize(b(this),g);i.fontSizes.push(m.fontSize);i.wordSpacings.push(m.wordSpacing);i.minFontSizes.push(m.minFontSize)});j.remove();b("head").append(Conformist.generateCss(k,i))});return this.trigger("conformed")}};b.fn.conform=Conformist._conform})(this,jQuery);